{% extends 'customer/base__next.html' %}
{% load static %}
{% load humanize %}

{% block inner__content %}
<section class="menu-detail">
  <div class="menu-top-view">
    {% if menu.img %}
      <img height=420 src="{{ menu.img.url }}" alt="Menu">
    {% endif %}

    {% block img %}
      {% include 'restaurant/modal/img.html' %}
    {% endblock %}

    <div class="text-box px-sm-5 px-2 py-1">
      <p class="text-left">{{ menu.name }}</p>
      <p class="text-right">¥ {{ menu.price | intcomma }}</p>
    </div>

    {% block text %}
      {% include 'restaurant/modal/text.html' %}
    {% endblock %}
  </div>

  <div class="px-2 py-3 menu-allergy">
    <div class="d-flex">
      <p class="text-left text__bold">アレルギー表示</p>
      <div class="ml-5">
        {% block allergy_edit %}
          {% include 'restaurant/modal/allergy.html' %}
        {% endblock %}
      </div>
    </div>
    <hr/>
    <div class="d-flex flex-wrap">
      {% for allergy in allergies %}
        {% if allergy in has_allergies %}
          <div class="allergy-box-brighten py-1 px-3 mr-1 mb-1">
            {{ allergy }}
          </div>
        {% else %}
          <div class="allergy-box py-1 px-3 mr-1 mb-1">
            {{ allergy }}
          </div>
        {% endif %}
      {% endfor %}

      {% block allergy %}
        {% include 'restaurant/modal/allergy_edit.html' %}
      {% endblock %}
    </div>

    <!-- TODO: new feature -->

    <!-- <p class="mt-5 text-left text__bold">シェフからのコメント</p>
    <hr/>
    <div class="row mx-auto">
      <img class="col-4 shadow chef" src="#" alt="Comment from Chef">
      <div class="col-8 shadow comment"></div>
    </div>

    <p class="mt-5 text-left text__bold">生産者からのメッセージ</p>
    <hr/>
    <div class="row mx-auto">
    </div> -->

    {% if not user.is_authenticated %}
      <form class="cart-form" action="{% url 'customer:cart' %}" method="POST">{% csrf_token %}
        <div class="d-flex input__fixed">
          <div class="text__bold">
            {{ add_to_cart_form }}
          </div>
          <p class="pl-2 text__bold d-flex align-items-center">個</p>
        </div>
        <!-- hidden -->
        <input type="hidden" name="menu_id" value="{{ menu.id }}">
        <input type="hidden" name="random_code" value="{{ random_code }}">
        <button type="submit" class="btn btn__orange btn__fixed shadow">追加</button>
      </form>
    {% endif %}
  </div>
</section>
{% endblock %}
