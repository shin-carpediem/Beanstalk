{% extends 'customer/base__next.html' %}
{% load static %}
{% load humanize %}

{% block inner__content %}
<section class="menu-list">
  <div class="category mb-3">
    <div class="d-flex ml-3">
      {% for category in categories %}
        <form action="{% url 'customer:category_filter' %}" method="POST">{% csrf_token %}
          <button type="submit" class="category-btn p-2 text__bold" name="category" value="{{ category }}">
            {{ category.name }}
          </button>
        </form>
      {% endfor %}
    </div>

    {% block category %}
      {% include 'restaurant/manage/category.html' %}
    {% endblock %}
  </div>

  {% if user.is_authenticated %}
    <div>
  {% else %}
    <form action="{% url 'customer:cart' %}" method="GET">
  {% endif %}

      <div class="d-flex flex-wrap">
        {% for menu in menus %}
          <a class="mx-auto my-1 menu-item shadow" href="{% url 'customer:menu_detail' menu.id %}">
            {% if menu.formatted_img %}
              <img src="{{ menu.formatted_img.url }}" alt="Menu">
            {% endif %}
            <div class="text-box">
              <p class="text-left pl-2">{{ menu.name }}</p>
              <p class="text-right pr-2">¥ {{ menu.price | intcomma }}</p>
            </div>
          </a>
          <!-- hidden -->
          <input type="hidden" name="menu_id" value="{{ menu.id }}">
          <input type="hidden" name="non_login_user_random_code" value="{{ random_code }}">
        {% endfor %}
      </div>

      {% if not user.is_authenticated %}
        <button class="btn btn__orange btn__fixed shadow">カートを見る</button>
      {% else %}
        {% block menu_modal %}
          {% include 'restaurant/manage/menu_modal.html' %}
        {% endblock %}
      {% endif %}

  {% if user.is_authenticated %}
    </form>
  {% else %}
    </div>
  {% endif %}
</section>
{% endblock %}
