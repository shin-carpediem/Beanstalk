{% extends 'customer/base__next.html' %}
{% load static %}
{% load humanize %}

{% block inner__content %}
<section class="menu-list">
  <div class="category mb-3">
    <div class="d-flex ml-3">
      {% for category in categories %}
        <form action="{% url 'customer:category_filter' %}" method="POST">{% csrf_token %}
          <!--TODO: 現在のカテゴリの時に色が付いた状態にする -->
          {% if category == '{{ category_name }}' %}
            <button type="submit" style="background-color: #ffd79a;" class="category-btn focus p-2 text__bold" name="category" value="{{ category }}">
          {% else %}
            <button type="submit" class="category-btn focus p-2 text__bold" name="category" value="{{ category }}">
          {% endif %}
              {{ category.name }}
            </button>
          <!-- hidden -->
          <input type="hidden" name="random_code" value="{{ random_code }}">
        </form>
      {% endfor %}
    </div>

    {% block category %}
      {% include 'restaurant/modal/category.html' %}
    {% endblock %}
  </div>

  {% if user.is_authenticated %}
    <div>
  {% else %}
    <form action="{% url 'customer:cart' %}" method="POST">{% csrf_token %}
  {% endif %}

      <div class="d-flex flex-wrap">
        {% for menu in menus %}
          <a class="mx-auto my-1 menu-item shadow" value="{{ random_code }}" href="{% url 'customer:menu_detail' menu.id %}">
            {% if menu.formatted_img %}
              <img src="{{ menu.formatted_img.url }}" alt="Menu">
            {% endif %}
            <div class="text-box">
              <p class="text-left pl-2">{{ menu.name }}</p>
              <p class="text-right pr-2">¥ {{ menu.price | intcomma }}</p>
            </div>
          </a>
          <!-- hidden -->
          <input type="hidden" name="menu_id" value="{{ menu.id }}">
        {% endfor %}
      </div>

      {% if user.is_authenticated %}
        {% block menu %}
          {% include 'restaurant/modal/menu.html' %}
        {% endblock %}
      {% else %}
        <input type="hidden" name="random_code" value="{{ random_code }}">
        <button type="submit" class="btn btn__orange btn__fixed shadow">カートを見る</button>
      {% endif %}

  {% if user.is_authenticated %}
    </div>
  {% else %}
    </form>
  {% endif %}
</section>
{% endblock %}
