{% extends 'customer/base__next.html' %}
{% load static %}
{% load humanize %}

{% block inner__content %}
<section class="menu-list">
  <div class="category mb-3">
    <div class="d-flex ml-3">
      {% for category in categories %}
        <form action="{% url 'customer:filter' %}" method="POST">{% csrf_token %}
          <!--TODO: 現在のカテゴリの時に色が付いた状態にする -->
          {% if category == "{{ category_name }}" %}
            <button type="submit" style="background-color: #ffd79a;" class="category-btn focus p-2 text__bold" name="category" value="{{ category }}">
          {% else %}
            <button type="submit" class="category-btn focus p-2 text__bold" name="category" value="{{ category }}">
          {% endif %}
              {{ category.name }}
            </button>
          <!-- hidden -->
          <input type="hidden" name="random_code" value="{{ random_code }}">
          <input type="hidden" name="table" value="{{ table_num }}">
        </form>
      {% endfor %}
    </div>

    {% include 'components/restaurant/modal/category.html' %}
  </div>

  <div class="d-flex flex-wrap">
    {% for menu in menus %}
      <form class="mx-auto my-1 menu-item shadow el__pointer" action="{% url 'customer:menu_detail' menu.id %}" method="POST">{% csrf_token %}
        <button type="submit" class="w-100 h-100 p-0 focus">
          {% if menu.formatted_img %}
            <img data-src="{{ menu.formatted_img.url }}" class="m-0 lazyload" alt="Menu">
          {% endif %}
          <div class="text-box">
            <p class="text-left pl-2">{{ menu.name }}</p>
            <p class="text-right pr-2">¥ {{ menu.price | intcomma }}</p>
          </div>
          <!-- hidden -->
          <input type="hidden" name="menu_id" value="{{ menu.id }}">
          <input type="hidden" name="random_code" value="{{ random_code }}">
          <input type="hidden" name="table" value="{{ table_num }}">
        </button>
      </form>
    {% endfor %}
  </div>

  {% if user.is_authenticated %}
    <div>
      {% include 'components/restaurant/modal/menu.html' %}
    </div>
  {% else %}
    <form action="{% url 'customer:cart' %}" method="POST">{% csrf_token %}
      <!-- hidden -->
      <input type="hidden" name="random_code" value="{{ random_code }}">
      <input type="hidden" name="table" value="{{ table_num }}">
      <button type="submit" class="btn btn__orange btn__fixed shadow">
        カートを見る
      </button>
    </form>
  {% endif %}
</section>
{% endblock %}
